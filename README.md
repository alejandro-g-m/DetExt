![DNS Logo](https://png.pngtree.com/svg/20170904/safety_dns_1214948.png)

# DetExt
> Detection of malicious data exfiltration over DNS using Machine Learning techniques

The DNS protocol can be used to exfiltrate data as a part of an individual cyberattack or in the process of an Advanced Persistent Thread. By analysing the DNS logs of the networking devices these attacks can be detected and stopped before a bigger harm is done to the objective of the attack. These logs can have thousands of lines in a small network, therefore, in big company networks the data to handle can be huge. For this reason, this project pretends to create an effective way to detect these attacks by using Machine Learning to analyse the data contained in the logs.

## Getting started

The project contains a series of Jupyter notebooks where the data is analysed and different techniques of Machine Learning are discussed to address the problem. These notebooks can be viewed directly on GitHub or they can be downloaded and run locally.

### Installation and setup

1. Clone or download repository.
2. Create a virtual environment with Python 3 (the version 3.6.5 has been used for development).
```shell
$ python3 -m venv venv
```
3. Activate the environment.
```shell
$ source venv/bin/activate
```
4. Install the requirements in requirements.txt.
```shell
$ pip3 install -r ./requirements.txt
```
---
* In order to run the Jupyter notebooks.
```shell
$ jupyter notebook
```

### Configuration

The tool used to log the DNS queries is [BRO](https://github.com/bro). Therefore, the function <i>create_feature_vector_from_log_file</i> in [feature_vector_creation.py](https://github.com/AlejandroGallego/dns-attacks-detection/blob/master/feature_vector_creation.py) expects a log format like the one generated by BRO.

Every line (except for the header and footer) should have this format:

```
ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	proto	trans_id	rtt	query	qclass	qclass_name	qtype	qtype_name	rcode	rcode_name	AA	TC	RD	RA	Z	answers	TTLs	rejected
```

In order to perform the supervised learning, the way to identify an attack is that they are all directed to a DNS server with the IP "1.1.1.1".

The function can be changed to parse other types of log files or to identify the attacks with another flag.
